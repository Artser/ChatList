# План реализации программы ChatList

## Этап 1: Подготовка проекта и структуры

### 1.1 Настройка окружения
- [ ] Обновить `requirements.txt` с необходимыми зависимостями:
  - PyQt5 (GUI)
  - requests или httpx (HTTP-запросы)
  - python-dotenv (работа с .env файлом)
  - sqlite3 (встроен в Python, но проверить использование)

### 1.2 Создание структуры проекта
- [ ] Создать модуль `db.py` для работы с базой данных
- [ ] Создать модуль `models.py` для логики работы с моделями
- [ ] Создать модуль `network.py` для отправки запросов к API
- [ ] Обновить `main.py` для основного интерфейса
- [ ] Создать файл `.env.example` с примером переменных окружения
- [ ] Создать файл `.gitignore` (уже создан, проверить наличие .env)

## Этап 2: Реализация базы данных (db.py)

### 2.1 Создание схемы БД
- [ ] Реализовать функцию инициализации БД `init_database()`
- [ ] Создать таблицу `prompts` (id, date, prompt, tags)
- [ ] Создать таблицу `models` (id, name, api_url, api_id, is_active)
- [ ] Создать таблицу `results` (id, prompt_id, model_id, response_text, created_at)
- [ ] Создать таблицу `settings` (id, key, value)

### 2.2 CRUD операции для prompts
- [ ] `create_prompt(prompt, tags)` - создание нового промта
- [ ] `get_all_prompts()` - получение всех промтов
- [ ] `get_prompt_by_id(prompt_id)` - получение промта по ID
- [ ] `search_prompts(query)` - поиск промтов
- [ ] `update_prompt(prompt_id, prompt, tags)` - обновление промта
- [ ] `delete_prompt(prompt_id)` - удаление промта

### 2.3 CRUD операции для models
- [ ] `create_model(name, api_url, api_id, is_active)` - создание модели
- [ ] `get_all_models()` - получение всех моделей
- [ ] `get_active_models()` - получение только активных моделей
- [ ] `update_model(model_id, **kwargs)` - обновление модели
- [ ] `toggle_model_active(model_id)` - переключение активности
- [ ] `delete_model(model_id)` - удаление модели

### 2.4 CRUD операции для results
- [ ] `save_results(results_list)` - сохранение списка результатов
- [ ] `get_all_results()` - получение всех результатов
- [ ] `get_results_by_prompt(prompt_id)` - получение результатов по промту
- [ ] `search_results(query)` - поиск результатов
- [ ] `delete_result(result_id)` - удаление результата

### 2.5 Операции для settings
- [ ] `get_setting(key, default=None)` - получение настройки
- [ ] `set_setting(key, value)` - установка настройки

## Этап 3: Реализация работы с моделями (models.py)

### 3.1 Класс Model
- [ ] Создать класс `Model` с атрибутами: id, name, api_url, api_id, is_active
- [ ] Реализовать методы для работы с моделью

### 3.2 Управление моделями
- [ ] Функция загрузки моделей из БД
- [ ] Функция фильтрации активных моделей
- [ ] Валидация данных модели

## Этап 4: Реализация сетевых запросов (network.py)

### 4.1 Загрузка API-ключей
- [ ] Функция загрузки переменных окружения из .env
- [ ] Валидация наличия необходимых ключей

### 4.2 Базовый класс для API-клиентов
- [ ] Создать базовый класс `BaseAPIClient`
- [ ] Реализовать общие методы (обработка ошибок, таймауты)

### 4.3 Реализация клиентов для разных API
- [ ] `OpenAIClient` - для OpenAI API
- [ ] `DeepSeekClient` - для DeepSeek API
- [ ] `GroqClient` - для Groq API
- [ ] Фабрика для создания клиентов по типу модели

### 4.4 Отправка запросов
- [ ] Функция `send_prompt_to_model(prompt, model)` - отправка промта в модель
- [ ] Обработка ошибок сети и API
- [ ] Логирование запросов (опционально)
- [ ] Асинхронная отправка запросов в несколько моделей параллельно

## Этап 5: Реализация GUI (main.py)

### 5.1 Основное окно приложения
- [ ] Создать класс `MainWindow(QMainWindow)`
- [ ] Настроить меню и панель инструментов
- [ ] Разделить окно на области: ввод промта, список промтов, результаты

### 5.2 Область ввода промта
- [ ] Текстовое поле для ввода нового промта
- [ ] Поле для ввода тегов
- [ ] Кнопка "Отправить запрос"
- [ ] Выпадающий список для выбора сохраненного промта
- [ ] Кнопка "Сохранить промт"

### 5.3 Область управления моделями
- [ ] Таблица со списком моделей
- [ ] Чекбоксы для активации/деактивации моделей
- [ ] Кнопки "Добавить модель", "Редактировать", "Удалить"
- [ ] Диалог добавления/редактирования модели

### 5.4 Область результатов (временная таблица)
- [ ] Таблица с колонками: модель, ответ, чекбокс "selected"
- [ ] Автоматическое обновление при получении ответов
- [ ] Индикатор загрузки во время отправки запросов
- [ ] Кнопка "Сохранить выбранные"
- [ ] Кнопка "Очистить"

### 5.5 Область сохраненных результатов
- [ ] Таблица с сохраненными результатами
- [ ] Фильтрация по промту, модели, дате
- [ ] Поиск по тексту ответа
- [ ] Кнопка "Экспорт" (Markdown/JSON)

### 5.6 Дополнительные функции интерфейса
- [ ] Поиск и сортировка во всех таблицах
- [ ] Контекстное меню для таблиц
- [ ] Диалог настроек программы

## Этап 6: Интеграция компонентов

### 6.1 Связывание модулей
- [ ] Инициализация БД при запуске приложения
- [ ] Загрузка моделей из БД в интерфейс
- [ ] Связь ввода промта с отправкой запросов
- [ ] Обновление временной таблицы результатов
- [ ] Сохранение выбранных результатов в БД

### 6.2 Обработка событий
- [ ] Обработчик нажатия "Отправить запрос"
- [ ] Обработчик нажатия "Сохранить выбранные"
- [ ] Обработчик выбора сохраненного промта
- [ ] Обработчик очистки временной таблицы

## Этап 7: Дополнительные функции

### 7.1 Поиск и сортировка
- [ ] Реализовать поиск в таблице prompts
- [ ] Реализовать поиск в таблице results
- [ ] Добавить сортировку по колонкам во всех таблицах

### 7.2 Экспорт данных
- [ ] Функция экспорта в Markdown
- [ ] Функция экспорта в JSON
- [ ] Диалог выбора формата и пути сохранения

### 7.3 Логирование (опционально)
- [ ] Настройка логирования запросов
- [ ] Сохранение логов в файл или БД

## Этап 8: Тестирование и отладка

### 8.1 Тестирование БД
- [ ] Проверить создание всех таблиц
- [ ] Протестировать все CRUD операции
- [ ] Проверить целостность данных

### 8.2 Тестирование сетевых запросов
- [ ] Протестировать запросы к каждой модели
- [ ] Проверить обработку ошибок
- [ ] Проверить таймауты

### 8.3 Тестирование GUI
- [ ] Проверить все элементы интерфейса
- [ ] Протестировать все действия пользователя
- [ ] Проверить работу с большим объемом данных

## Этап 9: Финальная сборка

### 9.1 Оптимизация
- [ ] Проверить размер исполняемого файла
- [ ] Оптимизировать импорты
- [ ] Проверить производительность

### 9.2 Документация
- [ ] Обновить README.md с инструкциями
- [ ] Добавить комментарии в код
- [ ] Создать пример .env файла

### 9.3 Сборка исполняемого файла
- [ ] Обновить build.ps1 при необходимости
- [ ] Собрать финальный .exe файл
- [ ] Протестировать исполняемый файл



